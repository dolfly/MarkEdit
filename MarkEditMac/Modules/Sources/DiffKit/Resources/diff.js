(function(){"use strict";class p{diff(e,n,t={}){let l;typeof t=="function"?(l=t,t={}):"callback"in t&&(l=t.callback);const i=this.castInput(e,t),o=this.castInput(n,t),r=this.removeEmpty(this.tokenize(i,t)),u=this.removeEmpty(this.tokenize(o,t));return this.diffWithOptionsObj(r,u,t,l)}diffWithOptionsObj(e,n,t,l){var i;const o=a=>{if(a=this.postProcess(a,t),l){setTimeout(function(){l(a)},0);return}else return a},r=n.length,u=e.length;let c=1,f=r+u;t.maxEditLength!=null&&(f=Math.min(f,t.maxEditLength));const C=(i=t.timeout)!==null&&i!==void 0?i:1/0,P=Date.now()+C,h=[{oldPos:-1,lastComponent:void 0}];let m=this.extractCommon(h[0],n,e,0,t);if(h[0].oldPos+1>=u&&m+1>=r)return o(this.buildValues(h[0].lastComponent,n,e));let y=-1/0,j=1/0;const z=()=>{for(let a=Math.max(y,-c);a<=Math.min(j,c);a+=2){let g;const W=h[a-1],x=h[a+1];W&&(h[a-1]=void 0);let O=!1;if(x){const F=x.oldPos-a;O=x&&0<=F&&F<r}const $=W&&W.oldPos+1<u;if(!O&&!$){h[a]=void 0;continue}if(!$||O&&W.oldPos<x.oldPos?g=this.addToPath(x,!0,!1,0,t):g=this.addToPath(W,!1,!0,1,t),m=this.extractCommon(g,n,e,a,t),g.oldPos+1>=u&&m+1>=r)return o(this.buildValues(g.lastComponent,n,e))||!0;h[a]=g,g.oldPos+1>=u&&(j=Math.min(j,a-1)),m+1>=r&&(y=Math.max(y,a+1))}c++};if(l)(function a(){setTimeout(function(){if(c>f||Date.now()>P)return l(void 0);z()||a()},0)})();else for(;c<=f&&Date.now()<=P;){const a=z();if(a)return a}}addToPath(e,n,t,l,i){const o=e.lastComponent;return o&&!i.oneChangePerToken&&o.added===n&&o.removed===t?{oldPos:e.oldPos+l,lastComponent:{count:o.count+1,added:n,removed:t,previousComponent:o.previousComponent}}:{oldPos:e.oldPos+l,lastComponent:{count:1,added:n,removed:t,previousComponent:o}}}extractCommon(e,n,t,l,i){const o=n.length,r=t.length;let u=e.oldPos,c=u-l,f=0;for(;c+1<o&&u+1<r&&this.equals(t[u+1],n[c+1],i);)c++,u++,f++,i.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return f&&!i.oneChangePerToken&&(e.lastComponent={count:f,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=u,c}equals(e,n,t){return t.comparator?t.comparator(e,n):e===n||!!t.ignoreCase&&e.toLowerCase()===n.toLowerCase()}removeEmpty(e){const n=[];for(let t=0;t<e.length;t++)e[t]&&n.push(e[t]);return n}castInput(e,n){return e}tokenize(e,n){return Array.from(e)}join(e){return e.join("")}postProcess(e,n){return e}get useLongestToken(){return!1}buildValues(e,n,t){const l=[];let i;for(;e;)l.push(e),i=e.previousComponent,delete e.previousComponent,e=i;l.reverse();const o=l.length;let r=0,u=0,c=0;for(;r<o;r++){const f=l[r];if(f.removed)f.value=this.join(t.slice(c,c+f.count)),c+=f.count;else{if(!f.added&&this.useLongestToken){let C=n.slice(u,u+f.count);C=C.map(function(P,h){const m=t[c+h];return m.length>P.length?m:P}),f.value=this.join(C)}else f.value=this.join(n.slice(u,u+f.count));u+=f.count,f.added||(c+=f.count)}}return l}}class N extends p{}const q=new N;function M(s,e,n){return q.diff(s,e,n)}function I(s,e){let n;for(n=0;n<s.length&&n<e.length;n++)if(s[n]!=e[n])return s.slice(0,n);return s.slice(0,n)}function T(s,e){let n;if(!s||!e||s[s.length-1]!=e[e.length-1])return"";for(n=0;n<s.length&&n<e.length;n++)if(s[s.length-(n+1)]!=e[e.length-(n+1)])return s.slice(-n);return s.slice(-n)}function D(s,e,n){if(s.slice(0,e.length)!=e)throw Error(`string ${JSON.stringify(s)} doesn't start with prefix ${JSON.stringify(e)}; this is a bug`);return n+s.slice(e.length)}function S(s,e,n){if(!e)return s+n;if(s.slice(-e.length)!=e)throw Error(`string ${JSON.stringify(s)} doesn't end with suffix ${JSON.stringify(e)}; this is a bug`);return s.slice(0,-e.length)+n}function v(s,e){return D(s,e,"")}function E(s,e){return S(s,e,"")}function k(s,e){return e.slice(0,J(s,e))}function J(s,e){let n=0;s.length>e.length&&(n=s.length-e.length);let t=e.length;s.length<e.length&&(t=s.length);const l=Array(t);let i=0;l[0]=0;for(let o=1;o<t;o++){for(e[o]==e[i]?l[o]=l[i]:l[o]=i;i>0&&e[o]!=e[i];)i=l[i];e[o]==e[i]&&i++}i=0;for(let o=n;o<s.length;o++){for(;i>0&&s[o]!=e[i];)i=l[i];s[o]==e[i]&&i++}return i}function w(s){let e;for(e=s.length-1;e>=0&&s[e].match(/\s/);e--);return s.substring(e+1)}function d(s){const e=s.match(/^\s*/);return e?e[0]:""}const L="a-zA-Z0-9_\\u{AD}\\u{C0}-\\u{D6}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",V=new RegExp(`[${L}]+|\\s+|[^${L}]`,"ug");class R extends p{equals(e,n,t){return t.ignoreCase&&(e=e.toLowerCase(),n=n.toLowerCase()),e.trim()===n.trim()}tokenize(e,n={}){let t;if(n.intlSegmenter){const o=n.intlSegmenter;if(o.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');t=[];for(const r of Array.from(o.segment(e))){const u=r.segment;t.length&&/\s/.test(t[t.length-1])&&/\s/.test(u)?t[t.length-1]+=u:t.push(u)}}else t=e.match(V)||[];const l=[];let i=null;return t.forEach(o=>{/\s/.test(o)?i==null?l.push(o):l.push(l.pop()+o):i!=null&&/\s/.test(i)?l[l.length-1]==i?l.push(l.pop()+o):l.push(i+o):l.push(o),i=o}),l}join(e){return e.map((n,t)=>t==0?n:n.replace(/^\s+/,"")).join("")}postProcess(e,n){if(!e||n.oneChangePerToken)return e;let t=null,l=null,i=null;return e.forEach(o=>{o.added?l=o:o.removed?i=o:((l||i)&&A(t,i,l,o),t=o,l=null,i=null)}),(l||i)&&A(t,i,l,null),e}}const _=new R;function B(s,e,n){return n?.ignoreWhitespace!=null&&!n.ignoreWhitespace?G(s,e,n):_.diff(s,e,n)}function A(s,e,n,t){if(e&&n){const l=d(e.value),i=w(e.value),o=d(n.value),r=w(n.value);if(s){const u=I(l,o);s.value=S(s.value,o,u),e.value=v(e.value,u),n.value=v(n.value,u)}if(t){const u=T(i,r);t.value=D(t.value,r,u),e.value=E(e.value,u),n.value=E(n.value,u)}}else if(n){if(s){const l=d(n.value);n.value=n.value.substring(l.length)}if(t){const l=d(t.value);t.value=t.value.substring(l.length)}}else if(s&&t){const l=d(t.value),i=d(e.value),o=w(e.value),r=I(l,i);e.value=v(e.value,r);const u=T(v(l,r),o);e.value=E(e.value,u),t.value=D(t.value,l,u),s.value=S(s.value,l,l.slice(0,l.length-u.length))}else if(t){const l=d(t.value),i=w(e.value),o=k(i,l);e.value=E(e.value,o)}else if(s){const l=w(s.value),i=d(e.value),o=k(l,i);e.value=v(e.value,o)}}class Z extends p{tokenize(e){const n=new RegExp(`(\\r?\\n)|[${L}]+|[^\\S\\n\\r]+|[^${L}]`,"ug");return e.match(n)||[]}}const b=new Z;function G(s,e,n){return b.diff(s,e,n)}class H extends p{constructor(){super(...arguments),this.tokenize=X}equals(e,n,t){return t.ignoreWhitespace?((!t.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!t.newlineIsToken||!n.includes(`
`))&&(n=n.trim())):t.ignoreNewlineAtEof&&!t.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),n.endsWith(`
`)&&(n=n.slice(0,-1))),super.equals(e,n,t)}}const Q=new H;function U(s,e,n){return Q.diff(s,e,n)}function X(s,e){e.stripTrailingCr&&(s=s.replace(/\r\n/g,`
`));const n=[],t=s.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(let l=0;l<t.length;l++){const i=t[l];l%2&&!e.newlineIsToken?n[n.length-1]+=i:n.push(i)}return n}window.diffLines=U,window.diffWords=B,window.diffChars=M})();
